<style>
  /* 左右分欄佈局 */
  .action-container {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 左右對半分 */
    gap: 15px;
    margin-top: 10px;
  }
  
  .side-title {
    font-size: 0.9rem; font-weight: bold; color: #5a5c69;
    margin-bottom: 10px; text-align: center; border-bottom: 2px solid #eee; padding-bottom: 5px;
  }

  /* 調整按鈕大小以適應分欄 */
  .item-btn {
    background: white; border: 2px solid #eaecf4; border-radius: 15px;
    padding: 12px 5px; font-size: 0.95rem; font-weight: 700;
    margin-bottom: 10px; text-align: center;
  }
  
  .btn-exchange { border-color: #e74a3b; color: #e74a3b; } /* 扣點紅 */
  .btn-gain { border-color: #1cc88a; color: #1cc88a; }     /* 新增綠 */

  /* 自定義輸入區 */
  .custom-input-box {
    background: #fff; border-radius: 15px; padding: 10px;
    border: 1px dashed var(--primary); margin-top: 10px;
  }
  .custom-input-box input {
    font-size: 0.9rem; margin-bottom: 5px;
  }
</style>

<div class="app-body">
  <div class="tab-content">
    <div class="tab-pane fade show active" id="tab-main">
      
      <div class="action-container">
        <div class="side-exchange">
          <div class="side-title text-danger">兌換 (每10點/1hr)</div>
          <div onclick="submitSpend(10)" class="item-btn btn-exchange">-10 點<br><small>1 小時</small></div>
          <div onclick="submitSpend(20)" class="item-btn btn-exchange">-20 點<br><small>2 小時</small></div>
          <div onclick="submitSpend(30)" class="item-btn btn-exchange">-30 點<br><small>3 小時</small></div>
        </div>

        <div class="side-gain">
          <div class="side-title text-success">集點項目</div>
          <div id="itemContainer"></div>
          
          <div class="custom-input-box">
            <small class="text-muted">自訂項目</small>
            <input type="text" id="custom-name" class="form-control form-control-sm" placeholder="內容">
            <input type="number" id="custom-score" class="form-control form-control-sm" placeholder="點數">
            <button onclick="addCustomRecord()" class="btn btn-success btn-sm w-100 mt-1">手動新增</button>
          </div>
        </div>
      </div>

    </div>
    </div>
</div>

<script>
  // 新增：處理自定義輸入
  async function addCustomRecord() {
    const name = document.getElementById('custom-name').value;
    const score = parseInt(document.getElementById('custom-score').value);
    if(!name || !score) return alert("請輸入完整內容與點數");
    
    toggleLoading(true);
    await fetch(GAS_URL, {
      method: 'POST',
      body: JSON.stringify({ items: [name], score: score, spend: 0 })
    });
    document.getElementById('custom-name').value = '';
    document.getElementById('custom-score').value = '';
    init();
    toggleLoading(false);
  }

  // 修改：處理不同額度的扣點
  async function submitSpend(amount) {
    if(!confirm(`確認扣除 ${amount} 點 (兌換 ${amount/10} 小時) 嗎？`)) return;
    toggleLoading(true);
    await fetch(GAS_URL, {
      method: 'POST',
      body: JSON.stringify({ items: [], spend: amount })
    });
    init();
    toggleLoading(false);
  }
</script>